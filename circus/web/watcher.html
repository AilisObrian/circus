<%inherit file="base.html"/>

<script type="text/javascript" src="/media/jquery.min.js"></script>
<script type="text/javascript" src="/media/jquery.sparkline.min.js"></script>
% if not client:
Not connected. Go <a href="/">back</a> to connect.
% endif

% if client:
<div><a href="/">Back</a></div>

<p><strong>${name}</strong> runs <strong>${client.get_option(name, 'numprocesses')}</strong> processes.</p>

<div class="panel">
    <div class="stats">
        %for pid in client.get_pids(name):
        <div class="stat" id="pid_${pid}">
            Process #${pid}
            <div>CPU : <span id="${pid}_cpu" class="sparklines"></span>
                </div>
                <div>Mem : <span id="${pid}_mem" class="sparklines"></span>
                    </div>
                </div>
                %endfor
            </div>
            <div style="clear: both"/>

                <a class="action" href="/watchers/${name}/process/incr">Add a process</a>
                <a class="action" href="/watchers/${name}/process/decr">Remove a process</a>
                <div style="clear: both"/>

                </div>
                <div class="panel">
                    <p>Options :</p>
                    <ul>
                        %for name_, value in client.get_options(name):
                        <li>${name_}: ${value}</li>
                        %endfor
                    </ul>
                </div>

               % endif
               
<script type="text/javascript">

function updateGraphs() {

    $.getJSON('/watchers/${name}/stats/cpu', function(data) {
            $.each(data, function(key, val) {
                var id = '#' + key + '_cpu';
                $(id).sparkline(val, {width: '75%'});
                });
            });
    $.getJSON('/watchers/${name}/stats/mem', function(data) {
            $.each(data, function(key, val) {
                var id = '#' + key + '_mem';
                $(id).sparkline(val, {width: '75%'});
                });
            });

}

// see if we want to provide this as a glider
setInterval("updateGraphs()", 2000);

</script>


